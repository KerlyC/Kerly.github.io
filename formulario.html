<html>
<head>

</head>
<body>
    <form id="crud-form">
        <label for="nombre">Nombre:</label>
        <input type="text" id="nombre">
        <label for="cedula">Cédula:</label>
        <input type="text" id="cedula">
        <label for="celular">Celular:</label>
        <input type="text" id="celular">
        <label for="ciudad">Ciudad:</label>
        <input type="text" id="ciudad">
        <label for="edad">Edad:</label>
        <input type="number" id="edad">
        <button type="button" onclick="crearRegistro()">Crear</button>
    </form>

    <ul id="lista-registros"></ul>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";
        import { getDatabase, ref, push, onValue, remove, update } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-database.js";

        const firebaseConfig = {
            // Tu configuración de Firebase aquí
        };

        // Inicializa Firebase
        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);

        window.crearRegistro = function () {
            const nombre = document.getElementById("nombre").value;
            const cedula = document.getElementById("cedula").value;
            const celular = document.getElementById("celular").value;
            const ciudad = document.getElementById("ciudad").value;
            const edad = document.getElementById("edad").value;

            push(
                ref(database, 'septimo'),
                {
                    name: nombre,
                    cedula: cedula,
                    celular: celular,
                    ciudad: ciudad,
                    age: edad
                }
            );

            // Limpia los campos después de agregar un nuevo registro
            document.getElementById("nombre").value = "";
            document.getElementById("cedula").value = "";
            document.getElementById("celular").value = "";
            document.getElementById("ciudad").value = "";
            document.getElementById("edad").value = "";
        }

        // Obtener y mostrar registros existentes
        const listaRegistros = document.getElementById("lista-registros");
        onValue(ref(database, 'septimo'), (snapshot) => {
            listaRegistros.innerHTML = ""; // Limpiar lista antes de actualizar

            snapshot.forEach((childSnapshot) => {
                const registro = childSnapshot.val();
                const li = document.createElement("li");
                li.textContent = `${registro.name} - Cédula: ${registro.cedula} - Celular: ${registro.celular} - Ciudad: ${registro.ciudad} - Edad: ${registro.age}`;
                listaRegistros.appendChild(li);

                // Agregar botones de eliminar y editar a cada elemento de la lista
                const btnEliminar = document.createElement("button");
                btnEliminar.textContent = "Eliminar";
                btnEliminar.onclick = () => eliminarRegistro(childSnapshot.key);
                li.appendChild(btnEliminar);

                const btnEditar = document.createElement("button");
                btnEditar.textContent = "Editar";
                btnEditar.onclick = () => editarRegistro(childSnapshot.key, registro);
                li.appendChild(btnEditar);
            });
        });

        window.eliminarRegistro = function (key) {
            remove(ref(database, `septimo/${key}`));
        }

        window.editarRegistro = function (key, registro) {
            const nuevoNombre = prompt("Nuevo nombre:", registro.name);
            const nuevaCedula = prompt("Nueva cédula:", registro.cedula);
            const nuevoCelular = prompt("Nuevo celular:", registro.celular);
            const nuevaCiudad = prompt("Nueva ciudad:", registro.ciudad);
            const nuevaEdad = prompt("Nueva edad:", registro.age);

            update(ref(database, `septimo/${key}`), {
                name: nuevoNombre,
                cedula: nuevaCedula,
                celular: nuevoCelular,
                ciudad: nuevaCiudad,
                age: nuevaEdad
            });
        }
    </script>
</body>
</html>
